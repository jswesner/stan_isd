% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  12pt,
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
\usepackage{setspace}\doublespacing
\usepackage{amsmath}
\usepackage{lineno}
\linenumbers
\usepackage{fontspec}
\setmainfont{Times New Roman}
\usepackage{placeins}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Bayesian hierarchical modeling of size spectra},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Bayesian hierarchical modeling of size spectra}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\emph{Jeff S. Wesner}\textsuperscript{1}, \emph{Justin P.F.
Pomeranz}\textsuperscript{2}, \emph{James R.
Junker}\textsuperscript{3,4}, \emph{Vojsava Gjoni}\textsuperscript{1}

\textsuperscript{1}University of South Dakota, Department of Biology,
Vermillion, SD 57069

\textsuperscript{2}Colorado Mesa University, Environmental Science and
Technology, Grand Junction, CO 81501

\textsuperscript{3}Great Lakes Research Center, Michigan Technological
University, Houghton, MI 49931

\textsuperscript{4}Louisiana Universities Marine Consortium, Chauvin, LA
70344

Corresponding Author:
\href{mailto:Jeff.Wesner@usd.edu}{\nolinkurl{Jeff.Wesner@usd.edu}}

Running Head: Bayesian Size Spectra

\emph{Data Archiving Statement}

All data, R code, and Stan code are available at
\url{https://github.com/jswesner/stan_isd} (to be permanently archived
at Zenodo upon acceptance). Body size data from the International
Benthic Trawl Surveys was retrieved from
\url{https://github.com/andrew-edwards/sizeSpectra/tree/master/data}.

\newpage

\hypertarget{abstract}{%
\section{Abstract}\label{abstract}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  A fundamental pattern in ecology is that smaller organisms are more
  abundant than larger organisms. This pattern is known as the
  individual size distribution (ISD), which is the frequency of all
  individual sizes in an ecosystem, regardless of taxon.
\item
  The ISD is described by power law distribution with the form
  \(f(x) = Cx^{\lambda}\), and a major goal of size spectra analyses is
  to estimate the ISD parameter \(\lambda\). However, while numerous
  methods have been developed to do this, they have focused almost
  exclusively on estimating \(\lambda\) from single samples.
\item
  Here, we develop an extension of the truncated Pareto distribution
  within the probabilistic modeling language Stan. We use it to estimate
  multiple ISD parameters simultaneously with a hierarchical modeling
  approach.
\item
  The most important result is the ability to examine hypotheses related
  to size spectra, including the assessment of fixed and random effects,
  within a single Bayesian generalized (non)-linear mixed model. While
  the example here uses size spectra, the technique can also be
  generalized to any data that follows a power law distribution.
\end{enumerate}

Keywords: \emph{Bayesian, body size spectra, hierarchical, Pareto, power
law, Stan}

\newpage

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

In any ecosystem, large individuals are typically more rare than small
individuals. This fundamental feature of ecosystems leads to a
remarkably common pattern in which relative abundance declines with
individual body size, generating the individual size distribution (ISD),
also called the community size spectrum (Sprules \emph{et al.} 1983;
White \emph{et al.} 2008). Understanding how body sizes are distributed
has been a focus in ecology for over a century (Peters \& Wassenberg
1983), in part because they represent an ataxic approach that reflects
fundamental measures of ecosystem structure and function, such as
trophic transfer efficiency (Kerr \& Dickie 2001; White \emph{et al.}
2007; Perkins \emph{et al.} 2019). Individual size distributions are
also predicted as a result of physiological limits associated with body
size, thereby emerging from predictions of metabolic theory and
energetic equivalence (Brown \emph{et al.} 2004).

More formally, the ISD is a frequency distribution that can be
approximated by a bounded power law with a single free parameter
\(\lambda\), corresponding to the following probability density function
(Edwards \emph{et al.} 2020):

\begin{equation}
f(x) = Cx^\lambda, x_{min} \le x \ge x_{max}
\end{equation}

where \(x\) is the body size (e.g., mass or volume) of an individual
regardless of taxon, \(x_{min}\) is the smallest individual attainable
and \(x_{max}\) is the largest possible individual (White \emph{et al.}
2008). \(C\) is a constant equal to:

\begin{equation}
 C = \begin{cases}\frac{\lambda + 1}{{x_{max}^{\lambda+1}} - {x_{min}^{\lambda+1}}}, \lambda \neq-1 \\
\frac{1}{{logx_{max}} - {logx_{min}}}, \lambda = -1\end{cases}
\end{equation}

This model is also known as the bounded power law or truncated Pareto
distribution. The terms ``bounded'' or ``truncated'' refer to the limits
of \(x_{min}\) and \(x_{max}\), which represent the minimum and maximum
attainable body size values (White \emph{et al.} 2008). In practice,
values of \(x_{min}\) and \(x_{max}\) often come from the minimum and
maximum body sizes in a data set or are estimated statistically (White
\emph{et al.} 2008; Edwards \emph{et al.} 2017).

A compelling feature of size spectra is that \(\lambda\) may vary little
across ecosystems as a result of physiological constraints that lead to
size-abundance patterns more broadly. Metabolic scaling theory predicts
\(\lambda + 1 = \frac{log10\alpha}{log10\beta} - 3/4\), where \(\alpha\)
is trophic transfer efficiency in the food web and \(\beta\) is the mean
predator-prey mass ratio (Reuman \emph{et al.} 2008). The value of
\(-3/4\) is the predicted scaling exponent of log abundance and log mass
(Damuth 1981; Peters \& Wassenberg 1983). It is the reciprocal of
scaling coefficient of metabolic rate and mass (0.75) (Brown \emph{et
al.} 2004) and as a result, values of \(\lambda + 1\) have been used to
estimate metabolic scaling across ecosystems (Reuman \emph{et al.} 2008;
Perkins \emph{et al.} 2018, 2019). Values of \textasciitilde-2 represent
a reasonable first guess of expected ISD exponents, with values of
ranging from -1.2 to -2 appearing in the literature (Andersen \& Beyer
2006; Blanchard \emph{et al.} 2009; Pomeranz \emph{et al.} 2022).

Whether \(\lambda\) represents a fixed or variable value is debated, but
it varies among samples and ecosystems (Blanchard \emph{et al.} 2009;
Perkins \emph{et al.} 2018; Pomeranz \emph{et al.} 2022). It is often
described by its ``steepness'', with more negative values (i.e.,
``steeper'') indicating lower abundance of large relative to small
individuals, and vice versa. These patterns of size frequency are an
emergent property of demographic processes (e.g., age-dependent
mortality), ecological interactions (e.g., size-structured predation,
trophic transfer efficiency), and physiological constraints (e.g.,
size-dependent metabolic rates) (Muller-Landau \emph{et al.} 2006;
Andersen \& Beyer 2006; White \emph{et al.} 2008). As a result,
variation in \(\lambda\) across ecosystems or across time can indicate
fundamental shifts in community structure or ecosystem functioning. For
example, overfishing in marine communities has been detected using size
spectra in which \(\lambda\) was steeper than expected, indicating fewer
large fish than expected (Jennings \& Blanchard 2004). Shifts in
\(\lambda\) have also been used to document responses to acid mine
drainage in streams (Pomeranz \emph{et al.} 2019), land use (Martínez
\emph{et al.} 2016), resource subsidies (Perkins \emph{et al.} 2018),
and temperature (O'Gorman \emph{et al.} 2017; Pomeranz \emph{et al.}
2022).

Given the ecological information it conveys, the data required to
estimate size spectra are deceptively simple; only a single column of
data are needed, in which each data point is a single measure of the
body size of an individual. As long as the body sizes are collected
systematically and without bias towards certain taxa or phenotypes,
there is no need to know any more ecological information about the data
points (e.g., taxon, trophic position, age, abundance). However, despite
the simple data requirement, the statistical models used to estimate
\(\lambda\) are diverse. Edwards \emph{et al.} (2017) documented eight
analytical methods. Six involved binning, in which the body sizes are
grouped into size bins (e.g., 2-49 mg, 50-150 mg, etc.) and then
counted, generating values for abundance within each size bin. Binning
and log-transformation allows \(\lambda\) to be estimated using simple
linear regression. Unfortunately, the binning process also removes most
of the variation in the data, collapsing information about 1000's of
individuals into just 6 or so bins. Doing so can lead to the wrong
values of \(\lambda\), sometimes drastically so (Goldstein \emph{et al.}
2004; White \emph{et al.} 2008; Pomeranz \emph{et al.} 2023).

An improved alternative to binning and linear regression is to fit the
body size data to a power law probability distribution (White \emph{et
al.} 2008; Edwards \emph{et al.} 2017, 2020). This method uses all raw
data observations directly to estimate \(\lambda\), typically using the
maximum likelihood estimation method (Edwards \emph{et al.} 2017). In
addition to estimating size spectra of single samples, ecologists have
used this method to examine how \(\lambda\) varies across environmental
gradients (Perkins \emph{et al.} 2019; Pomeranz \emph{et al.} 2022).
However, these analyses typically proceed in two steps. First,
\(\lambda\) is estimated individually from each collection (e.g., each
site or year, etc.). Second, the estimates are used as response
variables in a linear model to examine how they relate to corresponding
predictor variables (Edwards \emph{et al.} 2020). A downside to this
approach is that it treats body sizes (and subsequent \(\lambda\)'s) as
independent samples, even if they come from the same site or time. It
also removes information on sample size (number of individuals) used to
derive \(\lambda\). As a result, the approach not only separates the
data generation model from the predictor variables, but is also unable
to take advantage of partial pooling during model fitting.

Here, we develop a Bayesian model that uses the truncated Pareto
distribution to estimate \(\lambda\) in response to both fixed and
random predictor variables. The model extends the maximum likelihood
approach developed by Edwards \emph{et al.} (2020) and allows for a
flexible hierarchical structure, including partial pooling, within the
modeling language Stan (Stan Development Team 2022).

\hypertarget{methods}{%
\section{Methods}\label{methods}}

\hypertarget{translating-to-stan}{%
\subsection{Translating to Stan}\label{translating-to-stan}}

We first translated the probability density function described by
Edwards \emph{et al.} (2020) into Stan by converting it to the log
probability density function (lpdf). Stan is a probabilistic modeling
language that is capable of fitting complex models, including those with
custom lpdf's. The resulting lpdf is given as

\begin{equation}
 lpdf = \begin{cases}\text{log}\frac{\lambda + 1}{{x_{max}^{\lambda+1}} - {x_{min}^{\lambda+1}}} + \lambda\text{log}x, \lambda \neq-1 \\
\text{-log}({{\text{log}x_{max}} - {\text{log}x_{min}}}) -\text{log}x, \lambda = -1\end{cases}
\end{equation}

with all variables as described above. We call this the \(paretocustom\)
distribution, which we can now use to estimate \(\lambda\) of a given
data set. For example, an intercept-only model would look like this:

\begin{equation}x_i \sim paretocustom(\lambda, x_{min}, x_{max})$$ $$\lambda = \alpha$$ $$\alpha \sim Normal(\mu, \sigma)\end{equation}

where \(x_i\) is the \(i\)th individual body size, \(\lambda\) is the
size spectrum parameter (also referred to as the exponent), \(x_{min}\)
and \(x_{max}\) are as defined above, and \(\alpha\) is the intercept
with a prior probability distribution. In this case, we specified a
Normal prior since \(\lambda\) is continuous and can be positive or
negative, but this can be changed as needed.

The simple model above can be expanded to a generalized linear mixed
model by including fixed predictors (\(\boldsymbol\beta \textbf{X}\))
and/or varying intercepts (\(\alpha_{[x]}\)):

\begin{equation}x_{ij} \sim paretocustom(\lambda_j, x_{min, j}, x_{max, j})$$ $$\lambda = \alpha + \boldsymbol\beta \textbf{X} + \alpha_{[j]} + \alpha_{[x]}$$ $$\alpha \sim Normal(\mu_{\alpha}, \sigma_{\alpha})$$ $$\beta \sim Normal(\mu_{\beta},\sigma_{\beta})$$ $$\alpha_{[j]} \sim Normal(0, \sigma_{[j]})$$ $$\sigma_{[j]} \sim Exponential(\phi)$$ $$\alpha_{[x]} \sim Normal(0, \sigma_{[x]})$$ $$\sigma_{[x]} \sim Exponential(\phi)\end{equation}

with one or more \(\beta\) regression parameters, represented by the
vector \(\boldsymbol\beta\), for one or more fixed predictors
\(\textbf{X}\), and one or more varying intercepts \(\alpha_x\). We
specify \(\alpha_{j}\) separately because it is needed to account for
the non-independence of body sizes. In other words, each body size
\(x_i\) is clustered within each sample \(j\) and so they are not
independent and identically distributed. The addition of a varying
intercept for each sample accounts for this non-independence. Prior
distributions are given as \(Normal\) for the parameters and varying
intercept and \(Exponential\) for \(\sigma{[x]}\), but these can also be
changed as needed.

The model above assumes that each body size \(x\) represents a single
individual such that the data set might have many repeats for
individuals of the same size (e.g., \(x\) = \{0.2, 0.2, 0.2, 0.4, 0.4,
0.5, 9.8\}). However, when individual body sizes are repeated in a data
set, they are often accompanied by a count or density, such that the
data set above might instead consist of two columns with \(x\) = \{0.2,
0.4, 0.5, 9.8\} and \(counts\) = \{3, 2, 1, 1\}. To analyze this more
compact data set, Edwards \emph{et al.} (2020) developed a modification
of the log probability density function to include \(counts\):

\begin{equation}
 lpdf = \begin{cases}\textit{counts}(\text{log}\frac{\lambda + 1}{{x_{max}^{\lambda+1}} - {x_{min}^{\lambda+1}}} + \lambda\text{log}x), \lambda \neq-1 \\
\textit{counts}(
\text{-log}({{\text{log}x_{max}} - {\text{log}x_{min}}}) -\text{log}x, \lambda = -1\end{cases}.
\end{equation}

We refer to this as \(paretocounts\), such that the model can be fit by
using

\begin{equation}x_i\sim paretocounts(\lambda, x_{min}, x_{max}, counts)$$ $$\lambda = [\text{linear or non-linear model}] \text{ and}$$ $$\text{[priors]}.\end{equation}

Aside from adding \(counts\), the model is the same as presented above.
These models (\(paretocustom\) and \(paretocounts\)) allow us to test
how the size distribution parameter, \(\lambda\), varies in response to
continuous or categorical predictors and to include hierarchical
structure as needed.

\hypertarget{testing-the-models}{%
\subsection{Testing the models}\label{testing-the-models}}

The \(paretocustom\) and \(paretocounts\) lpdfs give the same results,
differing only in how the data are aggregated. For simplicity, we
demonstrate model performance here for the \(paretocounts\)
distribution, since the empirical data we used (see \emph{Case Study}
below) contains counts of individual body sizes. First, we tested for
parameter recovery using data simulated from a bounded power law with
known values of \(\lambda\). Second, we fit the model to fisheries trawl
data presented in Edwards \emph{et al.} (2020) to estimate the
hypothesis that \(\lambda\) declines over time.

\hypertarget{parameter-recovery-from-simulated-data}{%
\subsection{Parameter recovery from simulated
data}\label{parameter-recovery-from-simulated-data}}

To ensure that the models could recover known parameter values, we
simulated ten data sets from a bounded power law using the inverse
cumulative density function:

\begin{equation}
x_i = (\text{u}_ix_{max}^{(\lambda+1)} +  (1-\text{u}_i)  x_{min}^{(\lambda+1)} ) ^ {\frac{1}{(\lambda+1)}}
\end{equation}

where \(x_i\) is the individual body size from the \(i\)th simulation,
\(u_i\) is a unique draw from a \(Uniform(0,1)\) distribution, and all
other variables are the same as defined above. We set \(x_{min}\) = 1,
\(x_{max}\) = 1000, and simulated \(i\) = 1000 values from each of 10
\(\lambda\)'s ranging from -2.2 to -1.2. To generate \(counts\), we
rounded each simulated value to the nearest 0.001 and then tallied them.

We estimated the ten \(\lambda\) values in two ways. First, we fit a
separate intercept-only model to each of the ten data sets. Second, we
fit a varying intercept model (Gelman et al.~2014). The structure of
this model is \(\lambda = \alpha + \alpha_{[j]}\) where each group \(j\)
represents an offset from the mean value of lambda.

Finally, we simulated data for a regression model with a single
continuous predictor and a varying intercept:
\(\lambda = \alpha + \beta x + \alpha_{[j]}\), where \(\alpha\) = -1.5,
\(\beta\) = -0.1, and \(\sigma_{j}\) = 0.3. The predictor variable \(x\)
was a continuous predictor. Using these parameters, we simulated 18
\(\lambda\)'s, with each \(\lambda\) coming from one of three
\(x\)-values (-2, 0, 2), nested within 3 groups with each replicated
twice. From each \(\lambda\), we simulated 1000 individuals using the
procedure above, with \(x_{min}\) = 1 and \(x_{max}\) = 1000. Using
those 18,000 simulated body sizes (1000 sizes simulated from 18
\(\lambda\)'s), we fit a \(paretocounts\) regression model 40 times to
measure variation in parameter recovery among model runs.

\hypertarget{sample-size}{%
\subsection{Sample Size}\label{sample-size}}

We examined sensitivity to sample size (number of individual body sizes)
across three \(\lambda\) values (-2, -1.6, -1.2). For each \(\lambda\),
we varied the number of simulated individuals from 2 to 2048,
representing a \(2^n\) sequence with \(n\) ranging from 1 to 11. Each of
the 11 densities was replicated 10 times resulting in 110 datasets of
individual body sizes. We fit each data set using separate
intercept-only \(paretocounts\) models and then plotted the resulting
\(\lambda\) values as a function of sample size.

\hypertarget{case-studies}{%
\subsection{Case Studies}\label{case-studies}}

To examine model performance on empirical data, we re-ran a previously
published analysis from Edwards et al.~(2020). In Edwards' study, size
spectra parameters were first estimated separately for each sample using
maximum likelihood. Then the modeled parameters were used as response
variables in linear regression models. The goal was to test for linear
changes in size spectra over three decades using bi-yearly size data of
marine fishes collected from the International Benthic Trawl Survey
(IBTS). The data set and original model results are available in the
\texttt{sizeSpectra} package (Edwards \emph{et al.} 2017). We tested the
same hypothesis as Edwards \emph{et al.} (2020), but instead of using a
two-step process we fit a single model using the \(paretocounts\) lpdf.

\hypertarget{model-fitting}{%
\subsection{Model Fitting}\label{model-fitting}}

We fit each of the above models in \texttt{rstan} (Stan Development Team
2022) using 2 chains each with 1000 iterations. All models converged
with \(R_{hat}\)'s \textless1.01. If a known parameter value fell inside
the 95\% Credible Intervals (CrI), we considered parameter recovery
successful. For the replicated regression model, we also tallied the
number of times that the known value fell outside of the 95\% CrI.
Assessments of prior influence and model checking are available in
Appendix S1.

\hypertarget{data-availability-statement}{%
\subsection{Data Availability
Statement}\label{data-availability-statement}}

All data, R code, and Stan code are available at
\url{https://github.com/jswesner/stan_isd} (to be permanently archived
on acceptance).

\hypertarget{results}{%
\section{Results}\label{results}}

\hypertarget{parameter-recovery}{%
\subsection{Parameter Recovery}\label{parameter-recovery}}

For models fit to simulated individual data sets, all 95\% credible
intervals included the true value of \(\lambda\) and posterior medians
were no more than 0.05 units away from the true value (Table 1).
Similarly, when the same data set was fit using a varying intercepts
model, the posterior median intercept \(\alpha\) and group standard
deviation \(\sigma_{j}\) were nearly identical to the true values (Table
1). Using the varying intercept model to estimate group specific means
yielded similar results as using separate models per group (Figure 1a),
demonstrating that a single model can be used to estimate multiple size
spectra. The change from ``shallow'' to ``steep'' size spectra is also
evident in plots of the proportion of values \(\ge x\) (i.e., \(f(x)\)
from Eq. 1) (Figure 1b-d).

We also recovered regression parameters (\(\alpha\), \(\beta\)) along
with the group-level standard deviation (\(\sigma_{j}\); Figure 2).
Thirty-seven of the 40 models converged. Of those 37 models the true
value fell outside of the 95\% CrI once for \(\alpha\) and
\(\sigma_{j}\) and three times for \(\beta\) (Figure 2). Averaging the
deviations (posterior median minus the true value) among the replicates
indicated no bias in the modeled estimates (mean bias \(\pm\) sd:
\(\alpha\) = -0.01 \(\pm\) 0.05, \(\beta\) = 0001 \(\pm\) 0.004,
\(\sigma_{j}\) = 0.02 \(\pm\) 0.05).

\hypertarget{sample-size-1}{%
\subsection{Sample Size}\label{sample-size-1}}

Variation in modeled estimates was high for samples containing less than
100 individuals (Figure 3). For example, when the true \(\lambda\) value
was -2, samples with just 8 individuals yielded estimates ranging from
-2.7 to -1.7. By contrast, all samples with more than 300 individuals
captured the true \(\lambda\) with less than 0.1 unit of error (Figure
3).

\hypertarget{case-study}{%
\subsection{Case Study}\label{case-study}}

Using IBTS data (Edwards \emph{et al.} 2017) with a Bayesian
hierarchical regression, we found a negative trend over time. The ISD
parameter of IBTS trawl data declined by \textasciitilde0.001 units per
year, but with a 95\% CrI ranging from -0.005 to 0.002. These values
were nearly identical to those reported by Edwards et al.~(2020) using a
two-step approach (Table 2). An advantage of fitting the model in a
single Bayesian hierarchical framework is that estimates for individual
groups are pulled toward the mean via partial pooling. This is apparent
in comparing the unpooled MLE estimates (Figure 4a) to the partially
pooled Bayesian estimates in each year (Figure 4b).

\hypertarget{discussion}{%
\subsection{Discussion}\label{discussion}}

The most important result of this work is the ability to analyze ISD
parameters using fixed and random predictors in a hierarchical model.
Our approach allows ecologists to test hypotheses about size spectra
while avoiding the pitfalls of binning, which loses information and can
lead to biased estimates of \(\lambda\) (White \emph{et al.} 2008).
Maximum likelihood solves this problem by directly estimating the ISD,
but testing hypotheses with maximum likelihood is often done with a
two-step process in which \(\lambda\) is estimated individually for each
sample and the results are then used as response variables in linear or
non-linear models (Edwards \emph{et al.} 2020). Our approach merges
these steps, allowing for the incorporation of prior probabilities and
hierarchical structure.

The ability to incorporate prior information using Bayesian updating has
two practical advantages over the two-step process described above.
First, adding informative prior distributions can improve model fit by
limiting the MCMC sampler to reasonable sampling space. In other words
it would not be sensible to estimate the probability that \(\lambda\) is
-1,234 or -9. Without informative priors, those values (and more extreme
values) are considered equally likely and hence waste much of the
algorithm's sampling effort on unlikely values (e.g., (Wesner \&
Pomeranz 2021)).

Second, and most importantly, ecologists have much prior information on
the values that \(\lambda\) can take. For example, global analysis of
phytoplankton reveals values of -1.75, consistent with predictions based
on sub-linear scaling of metabolic rate with mass of -3/4 (Perkins
\emph{et al.} 2019). Alternatively, Sheldon's conjecture suggests that
\(\lambda\) is -2.05 (Andersen et al.~2006), a value reflecting
isometric scaling of metabolic rate and mass, with support in pelagic
marine food webs (Andersen \& Beyer 2006). However, benthic marine
systems typically have shallower exponents (e.g., \(\sim\) -1.4;
Blanchard \emph{et al.} (2009)), similar to those in some freshwater
stream ecosystems (\(\sim -1.25\) (Pomeranz \emph{et al.} 2022). While
the causes of these deviations from theoretical predictions are debated,
it is clear that values of \(\lambda\) are restricted to a relatively
narrow range between about -2.05 and -1.2. But this restriction is not
known to the truncated Pareto, which has no natural lower or upper
bounds on \(\lambda\) (White \emph{et al.} 2008). As a result, a prior
that places most of its probability mass on these values (e.g.,
\(Normal(-1.75, 0.2)\) seems appropriate. Such a continuous prior does
not prevent findings of larger or smaller \(\lambda\), but instead
places properly weighted skepticism on such values.

Similar to priors, partial pooling from varying intercepts provides
additional benefits, allowing for the incorporation of hierarchical
structure and pulling \(\lambda\) estimates towards the global mean
(Gelman 2005; Qian \emph{et al.} 2010). In the examples shown here, the
amount of pooling is relatively small because the sample sizes are large
(\textgreater1000 individuals). However, the primary benefit of pooling
(both from varying effects and skeptical priors) is in prediction
(Gelman 2005; Hobbs \& Hooten 2015). This becomes especially important
when models are used to forecast future ecosystem conditions. Forecasts
are becoming more common in ecology (Dietze \emph{et al.} 2018) and are
likely to be easier to test with modern long-term data sets like NEON
(National Ecological Observatory Network) in which body size samples
will be collected at the continental scale over at least the next 20
years (Kuhlman \emph{et al.} 2016). In addition, because the effects of
priors and pooling increase with smaller samples sizes, varying
intercepts are likely to be particularly helpful for small samples. In
other words, priors and partial pooling contain built-in skepticism of
extreme values, ensuring the maxim that ``extraordinary claims require
extraordinary evidence''.

One major drawback to the Bayesian modeling framework here is time.
Bayesian models of even minimal complexity must be estimated with Markov
Chain Monte Carlo techniques. In this study, we used the No U-Turn
sampling (NUTS) algorithm via \texttt{rstan} (Stan Development Team
2022). Stan can be substantially faster than other commonly used
programs such as JAGS and WinBUGS, which rely on Gibbs sampling. For
example, Stan is 10 to 1000 times more efficient than JAGS or WinBUGS,
with the differences becoming greater as model complexity increases
(Monnahan \emph{et al.} 2017). In the current study, intercept-only
models for individual samples with \(\sim\) 300 to 1500 individuals
could be fit quickly (\textless2 seconds total run time (warm-up +
sampling on a Lenovo T490 with 16GB RAM)) with as little as 1000
iterations and two chains. However, the IBTS regression models took
\textgreater2 hours to run with the same iterations and chains. These
times include the fact that our models used several optimization
techniques, such as informative priors, standardized predictors, and
non-centered parameterization, each of which are known to improve
convergence and reduce sampling time (McElreath 2016). But if Bayesian
inference is desired, these run-times may be worth the wait. In
addition, they are certain to become faster with the refinement of
existing algorithms and the introduction of newer ones like
Microcanonical HMC (Robnik \emph{et al.} 2022).

Body size distributions in ecosystems have been studied for decades, yet
comprehensive analytical approaches to testing these hypotheses are
lacking. We present a single analytical approach that takes advantage of
the underlying data structures of individual body sizes (Pareto
distributions) while placing them in a generalized (non)-linear
hierarchical modeling framework. We hope that ecologists will adopt and
improve on the models here to critically examine hypotheses of size
spectra or other power-law distributed data. Moreover, while the
examples here are for ecological size spectra, the statistical approach
is not limited to ecological data, but can be applied to analysis of
power law distributions that are common in a wide variety of disciplines
(Aban \emph{et al.} 2006; Clauset \emph{et al.} 2009).

\hypertarget{acknowledgements}{%
\section{Acknowledgements}\label{acknowledgements}}

This material is based upon work supported by the National Science
Foundation under Grant Nos. 2106067 to JSW and 2106068 to JRJ. We thank
Professor Yuhlong Lio for statistical and mathematical advice and
Edwards et al.~(2017) and (2020) for placing their code and data in
easily accessible repositories.

\hypertarget{references}{%
\section{References}\label{references}}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-aban2006parameter}{}}%
Aban, I.B., Meerschaert, M.M. \& Panorska, A.K. (2006). Parameter
estimation for the truncated pareto distribution. \emph{Journal of the
American Statistical Association}, \textbf{101}, 270--277.

\leavevmode\vadjust pre{\hypertarget{ref-andersen2006}{}}%
Andersen, K.H. \& Beyer, J.E. (2006).
\href{https://doi.org/10.1086/504849}{Asymptotic {Size Determines
Species Abundance} in the {Marine Size Spectrum}.} \emph{The American
Naturalist}, \textbf{168}, 54--61.

\leavevmode\vadjust pre{\hypertarget{ref-blanchard2009}{}}%
Blanchard, J.L., Jennings, S., Law, R., Castle, M.D., McCloghrie, P.,
Rochet, M.-J. \& Benoît, E. (2009).
\href{https://doi.org/10.1111/j.1365-2656.2008.01466.x}{How does
abundance scale with body size in coupled size-structured food webs?}
\emph{Journal of Animal Ecology}, \textbf{78}, 270--280.

\leavevmode\vadjust pre{\hypertarget{ref-brown2004}{}}%
Brown, J.H., Gillooly, J.F., Allen, A.P., Savage, V.M. \& West, G.B.
(2004). Toward a metabolic theory of ecology. \emph{Ecology},
\textbf{85}, 17711789.

\leavevmode\vadjust pre{\hypertarget{ref-clauset2009}{}}%
Clauset, A., Shalizi, C.R. \& Newman, M.E. (2009). Power-law
distributions in empirical data. \emph{SIAM review}, \textbf{51},
661703.

\leavevmode\vadjust pre{\hypertarget{ref-damuth1981population}{}}%
Damuth, J. (1981). Population density and body size in mammals.
\emph{Nature}, \textbf{290}, 699--700.

\leavevmode\vadjust pre{\hypertarget{ref-dietze2018iterative}{}}%
Dietze, M.C., Fox, A., Beck-Johnson, L.M., Betancourt, J.L., Hooten,
M.B., Jarnevich, C.S., Keitt, T.H., Kenney, M.A., Laney, C.M., Larsen,
L.G. \& others. (2018). Iterative near-term ecological forecasting:
Needs, opportunities, and challenges. \emph{Proceedings of the National
Academy of Sciences}, \textbf{115}, 1424--1432.

\leavevmode\vadjust pre{\hypertarget{ref-edwards2020}{}}%
Edwards, A.M., Robinson, J.P.W., Blanchard, J.L., Baum, J.K. \& Plank,
M.J. (2020). \href{https://doi.org/10.3354/meps13230}{Accounting for the
bin structure of data removes bias when fitting size spectra}.
\emph{Marine Ecology Progress Series}, \textbf{636}, 19--33.

\leavevmode\vadjust pre{\hypertarget{ref-edwards2017}{}}%
Edwards, A.M., Robinson, J.P.W., Plank, M.J., Baum, J.K. \& Blanchard,
J.L. (2017). \href{https://doi.org/10.1111/2041-210X.12641}{Testing and
recommending methods for fitting size spectra to data}. \emph{Methods in
Ecology and Evolution}, \textbf{8}, 57--67.

\leavevmode\vadjust pre{\hypertarget{ref-gelman2005}{}}%
Gelman, A. (2005).
\href{https://doi.org/10.1214/009053604000001048}{Analysis of
variance\textemdash why it is more important than ever}. \emph{The
Annals of Statistics}, \textbf{33}, 1--53.

\leavevmode\vadjust pre{\hypertarget{ref-goldstein2004problems}{}}%
Goldstein, M.L., Morris, S.A. \& Yen, G.G. (2004). Problems with fitting
to the power-law distribution. \emph{The European Physical Journal
B-Condensed Matter and Complex Systems}, \textbf{41}, 255--258.

\leavevmode\vadjust pre{\hypertarget{ref-hobbs2015}{}}%
Hobbs, N.T. \& Hooten, M.B. (2015).
\emph{\href{https://doi.org/10.23943/princeton/9780691159287.001.0001}{Bayesian
models: {A} statistical primer for ecologists}}. {Princeton University
Press}.

\leavevmode\vadjust pre{\hypertarget{ref-jennings_fish_2004}{}}%
Jennings, S. \& Blanchard, J.L. (2004). Fish abundance with no fishing:
Predictions based on macroecological theory. \emph{Journal of Animal
Ecology}, 632--642.

\leavevmode\vadjust pre{\hypertarget{ref-kerr2001}{}}%
Kerr, S.R. \& Dickie, L.M. (2001). \emph{The biomass spectrum: {A}
predator-prey theory of aquatic production}. {Columbia University
Press}.

\leavevmode\vadjust pre{\hypertarget{ref-kuhlman2016}{}}%
Kuhlman, M.R., Loescher, H.W., Leonard, R., Farnsworth, R., Dawson, T.E.
\& Kelly, E.F. (2016). \href{https://doi.org/10.1002/bes2.1248}{A {New
Engagement Model} to {Complete} and {Operate} the {National Ecological
Observatory Network}}. \emph{The Bulletin of the Ecological Society of
America}, \textbf{97}, 283--287.

\leavevmode\vadjust pre{\hypertarget{ref-martinez2016}{}}%
Martínez, A., Larrañaga, A., Miguélez, A., Yvon-Durocher, G. \& Pozo, J.
(2016). Land use change affects macroinvertebrate community size
spectrum in streams: the case of {\emph{Pinus radiata}} plantations.
\emph{Freshwater Biology}, \textbf{61}, 69--79. Retrieved from
\url{http://doi.wiley.com/10.1111/fwb.12680}

\leavevmode\vadjust pre{\hypertarget{ref-mcelreath2020}{}}%
McElreath, R. (2016). \emph{Statistical rethinking: {A} bayesian course
with examples in {R} and stan}, Secondn. {CRC Press}.

\leavevmode\vadjust pre{\hypertarget{ref-monnahan2017}{}}%
Monnahan, C.C., Thorson, J.T. \& Branch, T.A. (2017).
\href{https://doi.org/10.1111/2041-210X.12681}{Faster estimation of
{Bayesian} models in ecology using {Hamiltonian Monte Carlo}}.
\emph{Methods in Ecology and Evolution}, \textbf{8}, 339--348.

\leavevmode\vadjust pre{\hypertarget{ref-muller2006comparing}{}}%
Muller-Landau, H.C., Condit, R.S., Harms, K.E., Marks, C.O., Thomas,
S.C., Bunyavejchewin, S., Chuyong, G., Co, L., Davies, S., Foster, R. \&
others. (2006). Comparing tropical forest tree size distributions with
the predictions of metabolic ecology and equilibrium models.
\emph{Ecology letters}, \textbf{9}, 589--602.

\leavevmode\vadjust pre{\hypertarget{ref-ogorman2017}{}}%
O'Gorman, E.J., Zhao, L., Pichler, D.E., Adams, G., Friberg, N., Rall,
B.C., Seeney, A., Zhang, H., Reuman, D.C. \& Woodward, G. (2017).
\href{https://doi.org/10.1038/nclimate3368}{Unexpected changes in
community size structure in a natural warming experiment}. \emph{Nature
Climate Change}, \textbf{7}, 659--663.

\leavevmode\vadjust pre{\hypertarget{ref-perkins2018}{}}%
Perkins, D.M., Durance, I., Edwards, F.K., Grey, J., Hildrew, A.G.,
Jackson, M., Jones, J.I., Lauridsen, R.B., Layer-Dobra, K., Thompson,
M.S.A. \& Woodward, G. (2018).
\href{https://doi.org/10.1111/ele.13147}{Bending the rules: Exploitation
of allochthonous resources by a top-predator modifies size-abundance
scaling in stream food webs}. \emph{Ecology Letters}, \textbf{21},
1771--1780.

\leavevmode\vadjust pre{\hypertarget{ref-perkins2019}{}}%
Perkins, D.M., Perna, A., Adrian, R., Cermeño, P., Gaedke, U.,
Huete-Ortega, M., White, E.P. \& Yvon-Durocher, G. (2019).
\href{https://doi.org/10.1038/s41467-018-08039-3}{Energetic equivalence
underpins the size structure of tree and phytoplankton communities}.
\emph{Nature Communications}, \textbf{10}, 255.

\leavevmode\vadjust pre{\hypertarget{ref-peters1983effect}{}}%
Peters, R.H. \& Wassenberg, K. (1983). The effect of body size on animal
abundance. \emph{Oecologia}, \textbf{60}, 89--96.

\leavevmode\vadjust pre{\hypertarget{ref-pomeranz2023detecting}{}}%
Pomeranz, J.P., Junker, J.R., Gjoni, V. \& Wesner, J.S. (2023).
Detecting differences in size spectra. \emph{bioRxiv}, 2023--03.

\leavevmode\vadjust pre{\hypertarget{ref-pomeranz2022}{}}%
Pomeranz, J.P.F., Junker, J.R. \& Wesner, J.S. (2022).
\href{https://doi.org/10.1111/gcb.15862}{Individual size distributions
across {North American} streams vary with local temperature}.
\emph{Global Change Biology}, \textbf{28}, 848--858.

\leavevmode\vadjust pre{\hypertarget{ref-pomeranz2019}{}}%
Pomeranz, J.P.F., Warburton, H.J. \& Harding, J.S. (2019).
\href{https://doi.org/10.1111/fwb.13196}{Anthropogenic mining alters
macroinvertebrate size spectra in streams}. \emph{Freshwater Biology},
\textbf{64}, 81--92.

\leavevmode\vadjust pre{\hypertarget{ref-qian2010application}{}}%
Qian, S.S., Cuffney, T.F., Alameddine, I., McMahon, G. \& Reckhow, K.H.
(2010). On the application of multilevel modeling in environmental and
ecological studies. \emph{Ecology}, \textbf{91}, 355--361.

\leavevmode\vadjust pre{\hypertarget{ref-reuman2008three}{}}%
Reuman, D.C., Mulder, C., Raffaelli, D. \& Cohen, J.E. (2008). Three
allometric relations of population density to body mass: Theoretical
integration and empirical tests in 149 food webs. \emph{Ecology
Letters}, \textbf{11}, 1216--1228.

\leavevmode\vadjust pre{\hypertarget{ref-robnik2022}{}}%
Robnik, J., De Luca, G.B., Silverstein, E. \& Seljak, U. (2022).
Microcanonical {Hamiltonian Monte Carlo}. Retrieved from
\url{https://arxiv.org/abs/2212.08549}

\leavevmode\vadjust pre{\hypertarget{ref-sprules1983}{}}%
Sprules, W.G., Casselman, J.M. \& Shuter, B.J. (1983).
\href{https://doi.org/10.1139/f83-205}{Size {Distribution} of {Pelagic
Particles} in {Lakes}}. \emph{Canadian Journal of Fisheries and Aquatic
Sciences}, \textbf{40}, 1761--1769.

\leavevmode\vadjust pre{\hypertarget{ref-rstan2022}{}}%
Stan Development Team. (2022). {RStan}: The {R} interface to {Stan}.

\leavevmode\vadjust pre{\hypertarget{ref-wesner2021}{}}%
Wesner, J.S. \& Pomeranz, J.P.F. (2021).
\href{https://doi.org/10.1002/ecs2.3739}{Choosing priors in {Bayesian}
ecological models by simulating from the prior predictive distribution}.
\emph{Ecosphere}, \textbf{12}.

\leavevmode\vadjust pre{\hypertarget{ref-white2008}{}}%
White, E.P., Enquist, B.J. \& Green, J.L. (2008).
\href{https://doi.org/10.1890/07-1288.1}{On {Estimating} the {Exponent}
of {Power-Law Frequency Distributions}}. \emph{Ecology}, \textbf{89},
905--912.

\leavevmode\vadjust pre{\hypertarget{ref-white2007}{}}%
White, E.P., Ernest, S.K.M., Kerkhoff, A.J. \& Enquist, B.J. (2007).
\href{https://doi.org/10.1016/j.tree.2007.03.007}{Relationships between
body size and abundance in ecology}. \emph{Trends in Ecology \&
Evolution}, \textbf{22}, 323--330.

\end{CSLReferences}

\newpage

\hypertarget{tables}{%
\section{Tables}\label{tables}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.4868}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1316}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1447}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0789}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0789}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0789}}@{}}
\caption{Table 1. Parameter recovery of the same data using two
approaches. First, ten separate models individually recapture known
lambda values. Second, the same ten data sets are estimated in a single
hierarchical model. The true values are compared to the posterior median
and 95\% Credible Intervals.}\tabularnewline
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Model
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Parameter
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
True Value
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
q2.5
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
q50
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
q97.5
\end{minipage} \\
\midrule()
\endfirsthead
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Model
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Parameter
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
True Value
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
q2.5
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
q50
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
q97.5
\end{minipage} \\
\midrule()
\endhead
Separate Models & λ & -2.20 & -2.23 & -2.15 & -2.08 \\
Separate Models & λ & -2.09 & -2.15 & -2.09 & -2.02 \\
Separate Models & λ & -1.98 & -2.08 & -2.02 & -1.96 \\
Separate Models & λ & -1.87 & -1.93 & -1.87 & -1.81 \\
Separate Models & λ & -1.76 & -1.75 & -1.70 & -1.65 \\
Separate Models & λ & -1.64 & -1.65 & -1.60 & -1.56 \\
Separate Models & λ & -1.53 & -1.54 & -1.50 & -1.46 \\
Separate Models & λ & -1.42 & -1.45 & -1.42 & -1.38 \\
Separate Models & λ & -1.31 & -1.34 & -1.30 & -1.26 \\
Separate Models & λ & -1.20 & -1.23 & -1.20 & -1.16 \\
Single Model with Varying Intercepts & α & -1.70 & -1.96 & -1.71 &
-1.50 \\
Single Model with Varying Intercepts & σ\_{[}group{]} & 0.34 & 0.23 &
0.36 & 0.58 \\
\bottomrule()
\end{longtable}

\newpage

\begin{longtable}[]{@{}lrrr@{}}
\caption{Table 2. Slope values from a regression testing the
relationship between the ISD exponent and year for IBTS trawl data
(Edwards et al.~2020). The values are derived using the Bayesian
hierarchical model presented here or from the maximum likelihood
approach described in Edwards et al.~(2020).}\tabularnewline
\toprule()
Model & Mean & q2.5 & q97.5 \\
\midrule()
\endfirsthead
\toprule()
Model & Mean & q2.5 & q97.5 \\
\midrule()
\endhead
Bayesian - one step & -0.001 & -0.005 & 0.002 \\
MLE - two steps & -0.001 & -0.005 & 0.003 \\
\bottomrule()
\end{longtable}

\newpage

\hypertarget{figure-captions}{%
\section{Figure Captions}\label{figure-captions}}

Figure 1. a) Modeled estimates (median +/- 95\% Credible Intervals) of
\(\lambda\) using either 10 separate models or a single model with ten
varying intercepts. c-d) Fit of ISD relationships at 3 values of
\(\lambda\). Dots are raw data, lines are posterior medians, and shading
is the 95\% credible interval. Fits are from separate models.

Figure 2. Posterior distributions of n = 40 modeled estimates of alpha,
beta, and sigma\_j for a linear regression estimating the size spectrum
exponent as a function of a continuous predictor. All data were
simulated. Gray densities indicate that the 95\% CrI contains the true
value, while black densities indicate the true values fall outside of
the CrI. The vertical lines indicate true values.

Figure 3. Estimates of \(\lambda\)B across 11 different sample sizes
(ranging from 2 to 2048 individuals) and three different true
\(\lambda\)'s (-2, -1.6, -1.2). Ten separate models were fit for each of
the 11 sample sizes. The horizontal lines show the true value of
\(\lambda\).

Figure 4. Regression results from a) Edwards et al.~(2020) using maximum
likelihood and linear regression (two steps) and b) the Bayesian model
with varying intercepts. In a) the points represent maximum likelihood
estimates calculated separately for each year. In b) they represent
hierarchical varying intercepts calculated from the model.

\end{document}
